\documentclass[a4paper,12pt]{article}
\usepackage[koi8-r]{inputenc}
\usepackage[russian]{babel}
\usepackage{hyperref}
\usepackage{mathtext}
\usepackage[T2A]{fontenc}
\usepackage{array}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage[justification=centering,labelsep=period]{caption}
\usepackage{indentfirst}
\usepackage[pdftex]{graphicx,color}
\usepackage{textcomp}
\usepackage{gnuplot-lua-tikz}
\usepackage{tikz}
\usepackage[europeanresistors,americaninductors]{circuitikz}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage[top=20mm,bottom=20mm,left=20mm,right=20mm]{geometry}



% \renewcommand{\captionlabeldelim} {.}

\makeatletter
\renewcommand\@biblabel[1]{#1.}
\makeatother

\unitlength=1mm

\usepackage{listings} %% собственно, это и есть пакет listings
% \usepackage{caption}
\DeclareCaptionFont{white}{\color{white}} %% это сделает текст заголовка белым
%% код ниже нарисует серую рамочку вокруг заголовка кода.
\DeclareCaptionFormat{listing}{\colorbox{white}{\parbox{\textwidth}{#1#2#3}}}
% \captionsetup[lstlisting]{format=listing,labelfont=black,textfont=black}
\renewcommand{\lstlistingname}{Листинг}

\usetikzlibrary{circuits}
\usetikzlibrary{circuits.ee}
\usetikzlibrary{circuits.ee.IEC}
\usetikzlibrary{circuits.logic.IEC}
\usetikzlibrary{decorations.pathmorphing,patterns}
\usetikzlibrary{arrows}


\tikzset{circuit declare symbol = ac source}
\tikzset{set ac source graphic = ac source IEC graphic}
\tikzset{
         ac source IEC graphic/.style=
          {
           transform shape,
           circuit symbol lines,
           circuit symbol size = width 3 height 3,
           shape=generic circle IEC,
           /pgf/generic circle IEC/before background=
            {
             \pgfpathmoveto{\pgfpoint{0pt}{-0.8pt}}
             \pgfpathcosine{\pgfpoint{0.4pt}{0.4pt}}
             \pgfpathsine{\pgfpoint{-0.4pt}{0.4pt}}
             \pgfpathcosine{\pgfpoint{-0.4pt}{0.4pt}}
             \pgfpathsine{\pgfpoint{0.4pt}{0.4pt}}
             \pgfusepathqstroke
            }
          }
        }

\newcounter{nn}
\setcounter{nn}{0}
        
\begin{document}
 
\title{Семинар \textnumero 3 по курсу <<Электромагнитная совместимость
РЭС>>. \\ Моделирование помехоподавляющего фильтра нижних частот.}
\author{к.т.н., доцент кафедры ЭИУ1-КФ Кузнецов В.В.}

\maketitle

\section{Введение}

Целью семинара является изучение свойств помехоподавляющих пассивных
LC-фильтров, моделирование частотных зависимостей их S-параметров и
Z-параметров. 


\section{Пассивные фильтры}

Передаточные функции фильтров Чебышева, Баттерворта и Кауэра можно реализовать 
используя четырёхполюсник, содержащий только LC-элементы. 

Наиболее распространённой топологией пассивных фильтров является лестничный 
фильтр. Лестничный фильтр выполняется на основе П-образных звеньев. На 
рис.\ref{fig:ladder} и рис.\ref{fig:ladder_hpf} показаны схемы лестничных 
ФНЧ и ФВЧ соответственно. 

\begin{figure}[!ht]
\centering
\begin{tikzpicture}[circuit ee IEC]
% \begin{scope}[shift={(0,0)}]
\node (V1) [ac source,info={$e_i$},point up] at (-0.5,0) {};
\node (Zi) [resistor,point up, info={$Z_i$}] at (-0.5,1.2) {};

\foreach \x in {0,3,6} {
\begin{scope}[shift={(\x,0)}]
\stepcounter{nn}
\node (C2) [capacitor,point up,info'={$C_\thenn$}] at (1.5,0.5) {};
\stepcounter{nn}
\node (L1) [rotate=180,inductor, info'={$L_\thenn$}] at (2.5,2) {};

\node (gnd4) [ground,point down] at (1.5,-0.7) {};
\node (p5) [contact] at (1.5,2) {};
\draw (5,2) --  (L1) --  (p5);
\draw (gnd4) -- (C2) -- (p5);
\end{scope}
}


\node (gnd) [point down,ground] at (-0.5,-1.2) {};
\node (Zl) [resistor,point up,info'={$Z_н$}] at (10,0.5) {};
\node (gndl) [ground,point down] at (10,-0.7) {};
\draw (L1) -| (Zl) -- (gndl);
\draw (gnd) -- (V1) -- (Zi)  |- (1.5,2);
% \end{scope}
\end{tikzpicture}
\caption{Трёхзвённый лестничный ФНЧ 6-го порядка}\label{fig:ladder}
\end{figure}

\begin{figure}[!ht]
\centering
\begin{tikzpicture}[circuit ee IEC]
% \begin{scope}[shift={(0,0)}]
\node (V1) [ac source,info={$e_i$},point up] at (-0.5,0) {};
\node (Zi) [resistor,point up, info={$Z_i$}] at (-0.5,1.2) {};

\foreach \x in {0,3,6} {
\begin{scope}[shift={(\x,0)}]

\node (L1) [rotate=180,capacitor, info'={$C$}] at (2.5,2) {};
\node (C2) [inductor,point up,info'={$L$}] at (4,0.5) {};
\node (gnd4) [ground,point down] at (4,-0.7) {};
\node (p5) [contact] at (4,2) {};
\draw (1,2) --  (L1) --  (p5);
\draw (gnd4) -- (C2) -- (p5);
\end{scope}
}

\node (C1) [inductor, point up, info={$L$}] at (1,0.5) {};
\node (gnd2) [ground,point down] at (1,-0.7) {};
\node (p3) [contact] at (1,2) {};
\node (gnd) [point down,ground] at (-0.5,-1.2) {};
\node (Zl) [resistor,point up,info'={$Z_н$}] at (12,0.5) {};
\node (gndl) [ground,point down] at (12,-0.7) {};
\draw (p5) -| (Zl) -- (gndl);
\draw (gnd) -- (V1) -- (Zi)  |- (1,2);
\draw (gnd2) -- (C1) -- (p3);
% \end{scope}
\end{tikzpicture}
\caption{Трёхзвённый лестничный ФВЧ}\label{fig:ladder_hpf}
\end{figure}



В качестве примера рассмотрим расчёт элементов ФНЧ Баттерворта.
Для фильтра, включённого на нагрузку $Z_0=Z_i=Z_н$, $k$-й элемент 
(рис.\ref{fig:ladder}) фильтра $n$-го порядка c частотой среза $\omega_c = 2 
\pi f_c $ и  рассчитывается следующим образом:
\begin{alignat}{3}
 & \text{ёмкость (Ф):} \qquad & C_k = & \dfrac{X_k}{Z_0} \\
 & \text{индуктивность (Гн):}  \qquad & L_k = & X_k \cdot Z_0 \\
 & \text{где}         \qquad & X_k = & \dfrac{2}{\omega_c} \cdot \sin 
\dfrac{(2 k + 1)\cdot\pi}{2 n}
\end{alignat}

Индексация $k$ начинается с нуля. Например, чтобы найти значение $L_1$ в данные 
формулы нужно подставлять $k=0$, а чтобы найти $C_5$ нужно задать $k=4$.

Если LC-элементы с данными параметрами реализовать невозможно (например в 
СВЧ-фильтрах), то их можно заменить другими колебательными системами: МПЛ, 
кварцевыми резонаторами, устройствами функциональной электроники. Пассивные 
фильтры не обеспечивают усиление сигнала.

\subsection{Задание для самостоятельной работы}

 Пользуясь формулами из предыдущего раздела, рассчитать пассивный LC-фильтр 
Баттерворта 6-го порядка (схема рис.\ref{fig:ladder}) с частотой среза: 
$f_c=10\,кГц$ для группы РПД-111 и $f_c=16\, кГц$ для группы РПД\_С-111. 
Нагрузка фильтра $Z_0=600\, Ом$ . Промоделировать данный фильтр в Qucs и 
получить АЧХ. Какова частота среза фильтра. Расчёты и результаты моделирования 
включить в отчёт. 

\section{Схемы помехоподавляющих фильтров}


Основным средством подавления кондуктивных помех, создаваемых в цепях питания и
коммутации постоянного  и переменного токов аппаратуры, является фильтрация.
Предназначенные для этой цели фильтры позволяют снижать кондуктивные помехи как
от внешних так и от внутренних источников (например со стороны сети питания и
нагрузки). Эффективность фильтрации определяется вносимым затуханием фильтра
(дБ):

\begin{equation}
 S=20\lg\left|\frac{\dot{U_1}}{\dot{U_2}}\right|
\end{equation}

\begin{equation}
 S=20\lg\left|\frac{\dot{I_1}}{\dot{I_2}}\right|
\end{equation}

где $\dot{U_1}$, $\dot{I_1}$ --- напряжение и ток помех на нагрузке в исходном
состоянии, $\dot{U_2}$, $\dot{I_2}$ --- напряжение и ток помех на нагрузке в
цепи с фильтром.


По своему назначению помехоподавляющие фильтры являются широкополосными
фильтрами нижних частот (ФНЧ). Фильтры в цепях питания строятся как индуктивно-
или резистивно-емкостные (LC или RC). Наиболее частот применяется П-образный
LC-фильтр (схема рис.\ref{P-filt}).

\begin{figure}[!ht]
\begin{center}
\begin{tikzpicture}[circuit ee IEC]

% \begin{scope}[shift={(0,0)}]
\node (V1) [ac source,info={$e_i$},point up] at (-0.5,0) {};
\node (Zi) [resistor,point up, info={$Z_i$}] at (-0.5,1.2) {};
\node (C1) [capacitor, point up, info={$C$}] at (1,0.5) {};
\node (L1) [inductor, info={$L$}] at (2,2) {};
\node (C2) [capacitor,point up,info={$C$}] at (3,0.5) {};
\node (Zl) [resistor,point up,info={$Z_н$}] at (4,0.5) {};
\node (p1) [contact] at (-0.5,-0.7) {};
\node (p2) [contact] at (1,-0.7) {};
\node (p3) [contact] at (1,2) {};
\node (p4) [contact] at (3,-0.7) {};
\node (p5) [contact] at (3,2) {};
\node (gnd) [point down,ground] at (-0.5,-1.2) {};
\draw (gnd) -- (V1) -- (Zi) |- (L1) -| (Zl) |- (p1);
\draw (p2) -- (C1) -- (p3);
\draw (p4) -- (C2) -- (p5);
% \end{scope}
\end{tikzpicture}
\end{center}
\caption{Схема помехоподавляющего П-образного ФНЧ. $Z_i$ --- внутреннее
сопротивление источника, $Z_н$ --- внутренне сопротивление
нагрузки.}\label{P-filt}
\end{figure}

Затухание является частотнозависимым и определяется по выражению:
\begin{equation}
 S=20\lg\left|\frac{A_{11}+A_{12}+A_{21}Z_iZ_н+A_{22}Z_н}{Z_i+Z_н}\right|
\end{equation}
\begin{equation}
 A_{11}=1+\frac{Z_L}{Z_C}
\end{equation}
\begin{equation}
 A_{12}=Z_L
\end{equation}
\begin{equation}
 A_{21}=\frac{2}{Z_C}+\frac{Z_L}{Z_C^2}
\end{equation}
\begin{equation}
 A_{22}=\frac{1+Z_L}{Z_C}
\end{equation}
$Z_C$ и $Z_L$ --- индуктивное и емкостное сопротивления:
\begin{equation}
 Z_L=j\omega L
\end{equation}
\begin{equation}
 Z_C=\frac{1}{j\omega C}
\end{equation}



Для фильтрации помех в цепях постоянного тока применяется П-образный ФНЧ с
двухобмоточным дросселем с тороидальным ферритовым сердечником
(рис.\ref{P-filt2}). При использовании двухобмоточного дросселя постоянный
составляющие токов, протекающие по его обмоткам взаимно компенсируются и не
оказывает влияние на магнитные свойства сердечника. Нескомпенсированныя
постоянная составляющая приводит к снижению магнитной проницаемости сердечника,
снижению индуктивности катушки и снижению фильтрующих свойств.

\begin{figure}[!ht]
\centering
\begin{tikzpicture}[circuit ee IEC]
% \begin{scope}[shift={(0,0)}]
\node (V1) [ac source,info={$e_i$},point up] at (-0.5,0) {};
\node (Zi) [resistor,point up, info={$Z_i$}] at (-0.5,1.2) {};
\node (C1) [capacitor, point up, info={$C$}] at (1,0.5) {};
\node (L1) [rotate=180,inductor, info'={$L_1$}] at (2.5,1) {};
\node (L2) [inductor,info'={$L_2$}] at (2.5,0.5) {};
\node (C2) [capacitor,point up,info'={$C$}] at (4,0.5) {};
\node (Zl) [resistor,point up,info'={$Z_н$}] at (5,0.5) {};
\node (p1) [contact] at (-0.5,-0.7) {};
\node (p2) [contact] at (1,-0.7) {};
\node (p3) [contact] at (1,2) {};
\node (p4) [contact] at (4,-0.7) {};
\node (p5) [contact] at (4,2) {};
\node (gnd) [point down,ground] at (-0.5,-1.2) {};
\draw (gnd) -- (V1) -- (Zi)  |- (p3) -- ++(0.5,0) |- (L1);
\draw (p5) -- ++(-0.5,0) |- (L1);
\draw (p5) -| (Zl) |- (p4);
\draw (p4) -- ++(-0.5,0) |- (L2);
\draw (p1)-- (p2) -- ++(0.5,0) |- (L2);
\draw (p2) -- (C1) -- (p3);
\draw (p4) -- (C2) -- (p5);
\draw [very thick] (2,0.75) -- (3,0.75);
% \end{scope}
\end{tikzpicture}
\caption{Помехоподавляющий фильтр с двухобмоточным дросселем.}\label{P-filt2}
\end{figure}

Подобные фильтры включаются по входной цепи импульсных источников питания (ИИП).

Высокий коэффициент затухания не может быть получен с однозвённым фильтром,
поэтому применяется каскадирование фильтров. На рис.\ref{multisec} показан
трёхзвённый помехоподавляющий фильтр.

\begin{figure}[!ht]
\centering
\begin{tikzpicture}[circuit ee IEC]
% \begin{scope}[shift={(0,0)}]
\node (V1) [ac source,info={$e_i$},point up] at (-0.5,0) {};
\node (Zi) [resistor,point up, info={$Z_i$}] at (-0.5,1.2) {};

\foreach \x in {0,3.5,7} {
\begin{scope}[shift={(\x,0)}]

\node (L1) [rotate=180,inductor, info'={$L_1$}] at (2.5,1) {};
\node (L2) [inductor,info'={$L_2$}] at (2.5,0.5) {};
\node (C2) [capacitor,point up,info'={$C$}] at (4,0.5) {};
\node (p4) [contact] at (4,-0.7) {};
\node (p5) [contact] at (4,2) {};
\draw (1,2) -- ++(0.5,0) |- (L1);
\draw (p5) -- ++(-0.5,0) |- (L1);
\draw (p4) -- ++(-0.5,0) |- (L2);
\draw (1,-0.7) -- ++(0.5,0) |- (L2);
\draw (p4) -- (C2) -- (p5);
\draw [very thick] (2,0.75) -- (3,0.75);
\end{scope}
}
\foreach \x in {0,35mm} {
\draw [xshift=\x] (4,2) -- (4.5,2);
\draw [xshift=\x] (4,-0.7) -- (4.5,-0.7);
}
\node (C1) [capacitor, point up, info={$C$}] at (1,0.5) {};
\node (p1) [contact] at (-0.5,-0.7) {};
\node (p2) [contact] at (1,-0.7) {};
\node (p3) [contact] at (1,2) {};
\node (gnd) [point down,ground] at (-0.5,-1.2) {};
\node (Zl) [resistor,point up,info'={$Z_н$}] at (12,0.5) {};
\draw (p5) -| (Zl) |- (p4);
\draw (gnd) -- (V1) -- (Zi)  |- (1,2);
\draw (p1) -- (p2);
\draw (p2) -- (C1) -- (p3);
% \end{scope}
\end{tikzpicture}
\caption{Трёхзвенный помехоподавляющий фильтр с двухобмоточным
дросселем.}\label{multisec}
\end{figure}

При слишком большом числе звеньев фильтр становится громоздким, и высокое
затухание всё равно не может быть достигнуто, так как начинают проявляться
просачивания сигнала через паразитные ёмкости монтажа. Поэтому для многозвённых
фильтров целесообразно применение экранирования отдельных секций.

\subsection{S-параметры пассивного четырёхполюсника}


П-образный ФНЧ является пассивным четырёхполюсником. Свойства пассивного
четырёхполюсника в частотной области можно описать при помощи S-параметров.

Четырёхполюсником является любая электронная схема, имеющая один вход и один
выход: усилитель, фильтр, аттенюатор. Активный четырёхполюсник содержит
источники питания и может усиливать входной сигнал. Активный четырёхполюсник
как правило содержит биполярный или полевой транзистор, интегральный
операционный усилитель и т.п. схемы. Пассивный четырёхполюсник не имеет
источников питания. и не может усиливать сигнал. К пассивным четырёхполюсникам
относятся LC- и RC- фильтры которые содержат только индуктивность, ёмкость и
сопротивление.

В радиотехнике для того, чтобы охарактеризовать четырёхполюсник применяется
матрица S-параметров, или иначе матрица рассеяния. S-параметры устанавливают
связь между нормированными амплитудами напряжения и тока на входе и на выходе
четырёхполюсника. Если вход четырёхполюсника подключен к источнику переменного
тока (генератору колебаний) с некоторым выходным сопротивлением $Z_1$, то часть
энергии от источника передаётся на вход, а часть --- отражается от входа. Пусть
нормированная амплитуда падающей на вход волны равна $a_1$, а отражённой волны
$b_1$.

Такое же рассуждение справедливо и для выхода четырёхполюсника, к которому
подключена нагрузка с сопротивлением $Z_2$. Часть энергии, поступающей с выхода
четырёхполюсника, поглощается нагрузкой, а часть энергии --- отражается от неё
и поступает обратно в четырёхполюсник. Пусть нормированная амплитуда падающей на
нагрузку волны равна $a_2$, а отражённой от нагрузки волны $b_2$.

Нормированные амплитуды падающей и отражённой волны на входе и на выходе свзаны
через матрицу рассеяния:


\begin{eqnarray}
 b_1&=&S_{11}a_1+S_{12}a_2 \\
 b_2&=&S_{21}a_1+S_{22}a_2 
\end{eqnarray}


Физический смысл S-параметров следующий:

$S_{11}$ --- коэффициент отражения $\Gamma_1$ от входа четырёхполюсника.
Показывает степень согласования между источником входного сигнала (генератором
колебаний) и входными цепями четырёхполюсника. Если $S_{11}=0$, то вся энергия
от источника входного сигнала проходит на вход четырёхполюсника без отражения.

$S_{12}$ --- коэффициент обратной передачи. Показывает степень передачи
энергии с выхода четырёхполюсника на вход. Характеризует степень развязки между
входом и выходом, что показывает устойчивость активных четырёхполюсников.

$S_{21}$ --- коэффициент передачи. Равен коэффициенту усиления по мощности
четырёхполюсника. Для активных четырёхполюсников может быть больше единицы, а
для пассивных --- всегда меньше единицы.

$S_{22}$ --- коэффициент отражения $\Gamma_2$ от нагрузки. Показывает степень
передачи энергии с выхода в нагрузку. Если $S_{22}=0$, то вся энергия с выхода
четырёхполюсника поглощается нагрузкой без отражения. 

Для пассивных четырёхполюсников всегда $S_{21}=S_{12}$ и $S_{11}=S_{22}$, так
как внутрь четырёхполюсника не поступает дополнительная энергия от источников
питания. 

Матрица S-параметров может быть преобразована в матрицу Z-параметров. В Qucs
уже встроена готовая функция для расчёта S-параметров по S-параметрам. Она
называется \verb|stoz()|. Z-параметры представляют собой входное, выходное и
проходное сопротивление четырёхполюсника. Следует обратить внимание на
следующие Z-параметры:

$Z_{11}$ --- входное комплексное сопротивление (импеданс);

$Z_{22}$ --- выходное комплексное сопротивление (импеданс);




\section{Моделирование ФНЧ в программе Qucs}

\subsection{Моделирование П-образного ФНЧ}

Чтобы узнать параметры П-образного ФНЧ нужно произвести моделирование его
S-параметров. Частотной зависимости коэффициента передачи фильтра $S_{21}$
(АЧХ) будет соответствовать параметру \verb|S[2,1]|. Схема помехоподавляющего
фильтра в программе Qucs показана на рис.\ref{filt1-qucs}.

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=0.75\textwidth]{sem3img/filt1.pdf}
\end{center}
\caption{П-образный фильтр с двухобмоточным дросселем в Qucs.}\label{filt1-qucs}
\end{figure}

Параметры компонента \verb|Индуктивно связанные катушки| (Tr1) показаны на
рис.\ref{ind}. Используется дроссель с индуктивностью обмоток 2х0.8 мГн.
Диалоговое окно вызывается двойным щелчком по компоненту.

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=0.45\textwidth]{sem3img/transf.png}
\end{center}
\caption{Параметры трансформатора Tr1.}\label{ind}
\end{figure}

Частотная зависимость параметра $S_{21}$, полученная в результате моделирования,
показана на рис.\ref{filt1-qucs-s21}.

\begin{figure}[!ht]
\begin{center}
\includegraphics[width=0.75\textwidth]{sem3img/filt1-s21.pdf}
\end{center}
\caption{АЧХ П-образного ФНЧ.}\label{filt1-qucs-s21}
\end{figure}


\subsection{Задание для самостоятельной работы}

Собрать в программе Qucs схему на рис.\ref{filt1-qucs} и добиться её
работоспособности. Выполнить моделирование S-параметров и Z-параметров.
Построить графики частотной зависимости параметров $S_{21}$ (коэффициент
передачи) и $Z_{11}$ (входное сопротивление).

Промоделировать схему трёхзвённого П-образного ФНЧ (рис.\ref{P-filt2}).
Выполнить моделирование S-параметров и Z-параметров.
Построить графики частотной зависимости параметров $S_{21}$ (коэффициент
передачи) и $Z_{11}$ (входное сопротивление). Сравнить АЧХ однозвенного и
трёхзвенного фильтров. Чем объясняется различие АЧХ?


\section{Заключение}

В результате выполнения семинара студенты ознакомились с практическими
способами подавления индустриальных радиопомех в цепях питания РЭА при помощи
пассивных LC-ФНЧ. Произведено моделирование частотных параметров фильтров. 

\end{document}
